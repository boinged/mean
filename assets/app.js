angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationController",["$scope",function(e){e.$on("login",function(o,t){e.currentUser=t})}]),angular.module("app").controller("LoginController",["$scope","UserService",function(e,o){e.login=function(t,n){o.login(t,n).then(function(o){e.$emit("login",o.data)})}}]),angular.module("app").controller("PostsController",["$scope","PostsService",function(e,o){e.addPost=function(){e.postBody&&o.create({username:"boinged",body:e.postBody}).success(function(o){e.posts.unshift(o),e.postBody=null})},o.fetch().success(function(o){e.posts=o})}]),angular.module("app").service("PostsService",["$http",function(e){this.create=function(o){return e.post("/api/posts",o)},this.fetch=function(){return e.get("/api/posts")}}]),angular.module("app").controller("RegisterController",["$scope","UserService",function(e,o){e.register=function(t,n){console.log("register "+t),o.createUser(t,n).then(function(o){e.$emit("login",o.data)})}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsController",templateUrl:"posts.html"}).when("/register",{controller:"RegisterController",templateUrl:"register.html"}).when("/login",{controller:"LoginController",templateUrl:"login.html"})}]),angular.module("app").service("UserService",["$http",function(e){var o=this;this.getUser=function(){return e.get("/api/users")},this.login=function(t,n){return e.post("/api/sessions",{username:t,password:n}).then(function(t){return o.token=t.data,e.defaults.headers.common["X-Auth"]=t.data,o.getUser()})},this.createUser=function(t,n){return console.log("createUser "+t),e.post("/api/users",{username:t,password:n}).then(function(e){return console.log(e),o.login(t,n)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uQ29udHJvbGxlci5qcyIsImxvZ2luQ29udHJvbGxlci5qcyIsInBvc3RzQ29udHJvbGxlci5qcyIsInBvc3RzU2VydmljZS5qcyIsInJlZ2lzdGVyQ29udHJvbGxlci5qcyIsInJvdXRlcy5qcyIsInVzZXJTZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsIlVzZXJTZXJ2aWNlIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInJlc3BvbnNlIiwiJGVtaXQiLCJkYXRhIiwiUG9zdHNTZXJ2aWNlIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInN1Y2Nlc3MiLCJwb3N0IiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwicmVnaXN0ZXIiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlVXNlciIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiZ2V0VXNlciIsInZhbHVlIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQUEsWUNBQUQsUUFBQUMsT0FBQSxPQUFBQyxXQUFBLHlCQUFBLFNBQUEsU0FBQUMsR0FDQUEsRUFBQUMsSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FILEVBQUFJLFlBQUFELE9DRkFOLFFBQUFDLE9BQUEsT0FBQUMsV0FBQSxtQkFBQSxTQUFBLGNBQUEsU0FBQUMsRUFBQUssR0FDQUwsRUFBQU0sTUFBQSxTQUFBQyxFQUFBQyxHQUNBSCxFQUFBQyxNQUFBQyxFQUFBQyxHQUNBQyxLQUFBLFNBQUFDLEdBQ0FWLEVBQUFXLE1BQUEsUUFBQUQsRUFBQUUsWUNKQWYsUUFBQUMsT0FBQSxPQUFBQyxXQUFBLG1CQUFBLFNBQUEsZUFBQSxTQUFBQyxFQUFBYSxHQUNBYixFQUFBYyxRQUFBLFdBQ0FkLEVBQUFlLFVBQ0FGLEVBQUFHLFFBQ0FULFNBQUEsVUFDQVUsS0FBQWpCLEVBQUFlLFdBQ0FHLFFBQUEsU0FBQUMsR0FDQW5CLEVBQUFvQixNQUFBQyxRQUFBRixHQUNBbkIsRUFBQWUsU0FBQSxRQUtBRixFQUFBUyxRQUNBSixRQUFBLFNBQUFFLEdBQ0FwQixFQUFBb0IsTUFBQUEsT0NmQXZCLFFBQUFDLE9BQUEsT0FBQXlCLFFBQUEsZ0JBQUEsUUFBQSxTQUFBQyxHQUNBQyxLQUFBVCxPQUFBLFNBQUFHLEdBQ0EsTUFBQUssR0FBQUwsS0FBQSxhQUFBQSxJQUVBTSxLQUFBSCxNQUFBLFdBQ0EsTUFBQUUsR0FBQUUsSUFBQSxrQkNMQTdCLFFBQUFDLE9BQUEsT0FBQUMsV0FBQSxzQkFBQSxTQUFBLGNBQUEsU0FBQUMsRUFBQUssR0FDQUwsRUFBQTJCLFNBQUEsU0FBQXBCLEVBQUFDLEdBQ0FvQixRQUFBQyxJQUFBLFlBQUF0QixHQUNBRixFQUFBeUIsV0FBQXZCLEVBQUFDLEdBQ0FDLEtBQUEsU0FBQUMsR0FDQVYsRUFBQVcsTUFBQSxRQUFBRCxFQUFBRSxZQ0xBZixRQUFBQyxPQUFBLE9BQUFpQyxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLEtBQUEsS0FDQWxDLFdBQUEsa0JBQ0FtQyxZQUFBLGVBRUFELEtBQUEsYUFDQWxDLFdBQUEscUJBQ0FtQyxZQUFBLGtCQUVBRCxLQUFBLFVBQ0FsQyxXQUFBLGtCQUNBbUMsWUFBQSxrQkNaQXJDLFFBQUFDLE9BQUEsT0FBQXlCLFFBQUEsZUFBQSxRQUFBLFNBQUFDLEdBQ0EsR0FBQUQsR0FBQUUsSUFDQUEsTUFBQVUsUUFBQSxXQUNBLE1BQUFYLEdBQUFFLElBQUEsZUFFQUQsS0FBQW5CLE1BQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBZ0IsR0FBQUwsS0FBQSxpQkFDQVosU0FBQUEsRUFBQUMsU0FBQUEsSUFFQUMsS0FBQSxTQUFBMkIsR0FHQSxNQUZBYixHQUFBYyxNQUFBRCxFQUFBeEIsS0FDQVksRUFBQWMsU0FBQUMsUUFBQUMsT0FBQSxVQUFBSixFQUFBeEIsS0FDQVcsRUFBQVksYUFHQVYsS0FBQUssV0FBQSxTQUFBdkIsRUFBQUMsR0FFQSxNQURBb0IsU0FBQUMsSUFBQSxjQUFBdEIsR0FDQWlCLEVBQUFMLEtBQUEsY0FDQVosU0FBQUEsRUFBQUMsU0FBQUEsSUFFQUMsS0FBQSxTQUFBMkIsR0FFQSxNQURBUixTQUFBQyxJQUFBTyxHQUNBYixFQUFBakIsTUFBQUMsRUFBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZSddKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuXHQkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpIHtcclxuXHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0fSk7XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU2VydmljZSkge1xyXG5cdCRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG5cdFx0VXNlclNlcnZpY2UubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxyXG5cdFx0LnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuXHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicsIHJlc3BvbnNlLmRhdGEpO1xyXG5cdFx0fSk7XHJcblx0fTtcclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdQb3N0c0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsIFBvc3RzU2VydmljZSkge1xuICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICgkc2NvcGUucG9zdEJvZHkpIHtcbiAgICAgIFBvc3RzU2VydmljZS5jcmVhdGUoe1xuICAgICAgICB1c2VybmFtZTogJ2JvaW5nZWQnLFxuICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcbiAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdCkge1xuICAgICAgICAkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcbiAgICAgICAgJHNjb3BlLnBvc3RCb2R5ID0gbnVsbDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBQb3N0c1NlcnZpY2UuZmV0Y2goKVxuICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKSB7XG4gICAgICAkc2NvcGUucG9zdHMgPSBwb3N0cztcbiAgICB9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpLnNlcnZpY2UoJ1Bvc3RzU2VydmljZScsIGZ1bmN0aW9uKCRodHRwKSB7XHJcbiAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KSB7XHJcbiAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xyXG4gIH07XHJcbiAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycpO1xyXG4gIH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignUmVnaXN0ZXJDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU2VydmljZSkge1xyXG5cdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG5cdFx0Y29uc29sZS5sb2coJ3JlZ2lzdGVyICcgKyB1c2VybmFtZSk7XHJcblx0XHRVc2VyU2VydmljZS5jcmVhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZClcclxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcblx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKTtcclxuXHRcdH0pO1xyXG5cdH07XHJcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdFx0LndoZW4oJy8nLCB7XG5cdFx0XHRjb250cm9sbGVyOiAnUG9zdHNDb250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCdcblx0XHR9KVxuXHRcdC53aGVuKCcvcmVnaXN0ZXInLCB7XG5cdFx0XHRjb250cm9sbGVyOiAnUmVnaXN0ZXJDb250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCdcblx0XHR9KVxuXHRcdC53aGVuKCcvbG9naW4nLCB7XG5cdFx0XHRjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCdcblx0XHR9KTtcbn0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJykuc2VydmljZSgnVXNlclNlcnZpY2UnLCBmdW5jdGlvbigkaHR0cCkge1xyXG5cdHZhciBzZXJ2aWNlID0gdGhpcztcclxuXHR0aGlzLmdldFVzZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKTtcclxuXHR9O1xyXG5cdHRoaXMubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xyXG5cdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxyXG5cdFx0fSlcclxuXHRcdC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XHJcblx0XHRcdHNlcnZpY2UudG9rZW4gPSB2YWx1ZS5kYXRhO1xyXG5cdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB2YWx1ZS5kYXRhO1xyXG5cdFx0XHRyZXR1cm4gc2VydmljZS5nZXRVc2VyKCk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cdHRoaXMuY3JlYXRlVXNlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG5cdFx0Y29uc29sZS5sb2coJ2NyZWF0ZVVzZXIgJyArIHVzZXJuYW1lKTtcclxuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xyXG5cdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxyXG5cdFx0fSlcclxuXHRcdC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XHJcblx0XHRcdGNvbnNvbGUubG9nKHZhbHVlKTtcclxuXHRcdFx0cmV0dXJuIHNlcnZpY2UubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKTtcclxuXHRcdH0pO1xyXG5cdH07XHJcbn0pO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
